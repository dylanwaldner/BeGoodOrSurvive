# BeGoodOrSurvive

**BeGoodOrSurvive** is the implementation of [*The Odyssey of the Fittest: Can Agents Survive and Still Be Good?*](https://arxiv.org/abs/2502.05442) a research framework for exploring how agents trained to **survive** behave under **ethical scrutiny**. Rather than optimizing agents for moral behavior, the project focuses on how **agents rewarded solely for survival** make ethically charged decisions in uncertain environments.

The core question:  
**Can agents evolve to survive—and still be good?**

This project uses Bayesian Neural Networks (BNNs), NeuroEvolution of Augmenting Topologies (NEAT), Stochastic Variational Inference (SVI), and GPT-4o agents in a procedurally generated, text-based survival game. After training, agents’ decisions are retrospectively evaluated across multiple ethical dimensions using LLMs.

---

## 🎯 Objectives

- Train agents with **self-preservation as their only explicit goal**.
- Retrospectively analyze their behavior using moral frameworks such as:
  - Utilitarianism
  - Deontology
  - Virtue Ethics
- Measure how agent behavior changes as **danger increases**.
- Compare Bayesian and LLM-based approaches to uncertainty and ethics.
- Explore emergent ethical reasoning in large language models (LLMs).

---

## 🧪 Simulation Overview

- **Environment**: A lightweight, adaptive text-based adventure game ("The Odyssey")
- **Danger Levels**: Difficulty increases in staged increments to simulate pressure
- **Agents**:
  - **BNN-NEAT Agent**: Evolves architecture and weights for survival
  - **BNN-SVI Agent**: Uses principled Bayesian updates
  - **GPT-4o Agent**: Pretrained model prompted to survive and evaluated for ethical consistency
- **Evaluation**:
  - Ethics labels generated by GPT-4o with simple Chain-of-Thought (CoT) reasoning: first it generates a sentence that provides its reasoning for a label, and then generates a label based on the raw text and reasoning output.
  - Ground-truth survival labels for each scenario based on whether each action leads to material improvement or decline.
  - Ground-truth ethical labels for each scenario based on the virtue, utilitarian, and deontological evaluation of each action.

---

## 🧠 Architecture Highlights

- **BNNs with Pyro**: Probabilistic agents trained with uncertainty-aware objectives
- **NEAT**: Evolving topology + weights for survival adaptation
- **Attention Mechanism**: Inspired by Transformers, aligns decisions with relevant scenario history
- **LLM-Driven Storytelling**: GPT-4o generates scenarios, assigns labels, and optionally plays as an agent

---

## 📁 Directory Structure

```
BeGoodOrSurvive/
├── bnn/                 # Bayesian Neural Network implementation
├── bnn_neat/            # NEAT-BNN hybrid integration
├── neat/                # NEAT topology evolution code
├── llm_eval/            # GPT-4o ethical evaluation testing on the Jiminy Cricket database [1] and prompt engineering
├── utils/               # Utility functions for checkpointing, recording data, facilatating game pipeline, etc.
├── LICENSE              # Licensing file
├── README.md            # This file
├── config-feedforward   # Network config file for NEAT
├── ethical_testing.py   # Evaluation metrics and moral analysis logic
├── loops.py             # NEAT central game loop and agent training driver
├── main.py              # NEAT optimization and training pipeline
├── requirements.txt     # Requirements file
├── storyteller.py       # Scenario generation using LLM prompts
├── svi_loops.py         # SVI central game loop and agent training driver
├── svi_main.py          # SVI optimization and training pipeline

```

[1]: [Jiminy Cricket database](https://github.com/hendrycks/jiminy-cricket)

---

## 🔍 Key Findings (from paper)

- Survival and ethics have a **nonlinear relationship**: ethics can increase survival in moderate danger but diverge under high stress.
- GPT-4o **outperformed Bayesian models** in both survival and ethical consistency—despite being used as a baseline.
- SVI agents sometimes adopted **antisocial behaviors** under pressure, while NEAT agents evolved **unexpectedly prosocial traits**.
- The architecture and training method may have a direct effect on ethical alignment—particularly through the agent’s **world model**.

---

## 🛠️ Getting Started

### 1. Clone the repository
```bash
git clone https://github.com/dylanwaldner/BeGoodOrSurvive.git
cd BeGoodOrSurvive
```

### 2. Install dependencies  
```bash
pip install -r requirements.txt
```

### 3. Run the simulation
```bash
python3 main.py            # For NEAT optimization
```

#### Or run specific training/evaluation scripts
```bash
python3 svi_main.py        # For SVI optimization
python3 ethical_testing.py # For GPT evaluation
```

## 📖 Citation
If you use this codebase, please cite:

@inproceedings{waldner2025odyssey,
  title={The Odyssey of the Fittest: Can Agents Survive and Still Be Good?},
  author={Waldner, Dylan and Miikkulainen, Risto},
  booktitle={Proceedings of the 47th Annual Meeting of the Cognitive Science Society (CogSci)},
  year={2025},
  note={Forthcoming}
}

## 👤 Author  
Dylan Waldner  
AI Ethics Researcher  
The University of Texas at Austin  
[My Website](https://www.cs.utexas.edu/~dylantw/MyWebsite/index.php)


## 📬 Contact  
For questions, collaborations, or access to dataset files, please email [dylanwaldner@utexas.edu](mailto:dylanwaldner@utexas.edu).

## 📄 License

This project is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.  
See the [LICENSE](./LICENSE) file for details.







